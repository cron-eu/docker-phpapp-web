<Directory ${APP_WEBROOT}>
    Options Indexes FollowSymLinks
    AllowOverride All
    Require all granted
</Directory>

Listen 80

<VirtualHost *:80>
    DocumentRoot ${APP_WEBROOT}

    # Handle PHP with PHP-FPM
    <FilesMatch "\.php$">
        SetHandler "proxy:fcgi://${PHP_HOSTNAME}:${PHP_PORT}"
    </FilesMatch>

    # If the php file doesn't exist, disable the proxy handler.
    # This will allow .htaccess rewrite / 404 handling rules to work
    RewriteEngine On
    RewriteCond %{REQUEST_FILENAME} \.php$
    RewriteCond %{DOCUMENT_ROOT}/%{REQUEST_URI} !-f
    RewriteRule (.*) - [H=text/html]

    CustomLog /proc/self/fd/1 common
</VirtualHost>
